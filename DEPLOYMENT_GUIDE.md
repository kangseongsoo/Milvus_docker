# ğŸš€ ë°°í¬ ê°€ì´ë“œ: í…ŒìŠ¤íŠ¸ vs ìš´ì˜

## ğŸ“‹ ëª©ì°¨

1. [í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì„±](#í…ŒìŠ¤íŠ¸-í™˜ê²½)
2. [ìš´ì˜ ì„œë²„ êµ¬ì„± ë°©ì•ˆ](#ìš´ì˜-ì„œë²„-êµ¬ì„±)
3. [ì•„í‚¤í…ì²˜ ë¹„êµ](#ì•„í‚¤í…ì²˜-ë¹„êµ)
4. [ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ](#ë§ˆì´ê·¸ë ˆì´ì…˜)

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ í™˜ê²½

### êµ¬ì„±
```
ë‹¨ì¼ ì„œë²„ (All-in-One)
â”œâ”€â”€ Docker Compose
â”‚   â”œâ”€â”€ Milvus (19530)
â”‚   â”œâ”€â”€ PostgreSQL (5432)
â”‚   â”œâ”€â”€ Attu (3000)
â”‚   â”œâ”€â”€ etcd
â”‚   â””â”€â”€ MinIO
â””â”€â”€ FastAPI (8000)

ë¦¬ì†ŒìŠ¤:
- CPU: 8-16 ì½”ì–´
- RAM: 32GB
- Disk: 500GB SSD
```

### ì‹¤í–‰ ë°©ë²•

```bash
# í…ŒìŠ¤íŠ¸ í™˜ê²½ ì‹œì‘
cd 01.Docker_compose
docker-compose up -d

# FastAPI ì‹¤í–‰
cd ..
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### ìš©ë„
- âœ… ê°œë°œ ë° í…ŒìŠ¤íŠ¸
- âœ… ì†Œê·œëª¨ ë°ì´í„° (íŒŒí‹°ì…˜ 1-10ê°œ)
- âœ… í”„ë¡œí† íƒ€ì´í•‘
- âœ… CI/CD í…ŒìŠ¤íŠ¸

---

## ğŸ¢ ìš´ì˜ ì„œë²„ êµ¬ì„±

### ë°©ì•ˆ 1: ë‹¨ì¼ ì„œë²„ (Small-Medium Scale) â­ ê¶Œì¥ (ì‹œì‘)

**êµ¬ì„±:**
```
ë‹¨ì¼ ê³ ì„±ëŠ¥ ì„œë²„
â”œâ”€â”€ Docker Compose
â”‚   â”œâ”€â”€ Milvus
â”‚   â”œâ”€â”€ PostgreSQL
â”‚   â”œâ”€â”€ Attu
â”‚   â”œâ”€â”€ etcd
â”‚   â””â”€â”€ MinIO
â”œâ”€â”€ FastAPI (Docker ë˜ëŠ” ì§ì ‘ ì‹¤í–‰)
â””â”€â”€ ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ (NFS ë§ˆìš´íŠ¸)

ë¦¬ì†ŒìŠ¤:
- CPU: 32-64 ì½”ì–´
- RAM: 128-256GB
- Disk: 2TB NVMe SSD (OS/ìºì‹œ)
- Storage: 10-50TB NFS (ë°ì´í„°)
```

**ì¥ì :**
- âœ… êµ¬ì„± ê°„ë‹¨
- âœ… ê´€ë¦¬ ìš©ì´
- âœ… ë¹„ìš© íš¨ìœ¨ì 
- âœ… íŒŒí‹°ì…˜ 50ê°œê¹Œì§€ ì¶©ë¶„

**ì ìš© ì‹œë‚˜ë¦¬ì˜¤:**
```
ë°ì´í„° ê·œëª¨:
- íŒŒí‹°ì…˜: 10-50ê°œ
- ì´ ë°ì´í„°: 3ì–µ-15ì–µ ë²¡í„°
- ì´ ìš©ëŸ‰: 500GB - 2.5TB

ì„±ëŠ¥:
- ê²€ìƒ‰ ì†ë„: 15-20ms
- ë™ì‹œ ìš”ì²­: 100-500 req/s
```

**docker-compose.yml:**
```yaml
# ì´ë¯¸ ì‘ì„±ëœ docker-compose.production.yml ì‚¬ìš©
# ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ ë§ˆìš´íŠ¸ë§Œ ì„¤ì •
```

---

### ë°©ì•ˆ 2: ì„œë¹„ìŠ¤ ë¶„ë¦¬ (Medium-Large Scale) ğŸ† ê¶Œì¥ (í™•ì¥)

**êµ¬ì„±:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 1: FastAPI (API ì„œë²„)               â”‚
â”‚ - FastAPI ì¸ìŠ¤í„´ìŠ¤ Ã— 4                   â”‚
â”‚ - ì„ë² ë”© ì²˜ë¦¬                             â”‚
â”‚ - Load Balancer (Nginx)                 â”‚
â”‚ - CPU: 16ì½”ì–´, RAM: 32GB                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ â†“ â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 2: Milvus (ë²¡í„° DB)                 â”‚
â”‚ - Milvus Standalone                     â”‚
â”‚ - etcd, MinIO                           â”‚
â”‚ - CPU: 32ì½”ì–´, RAM: 256GB               â”‚
â”‚ - Disk: 2TB NVMe (ìºì‹œ)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 3: PostgreSQL (ë©”íƒ€ë°ì´í„°)          â”‚
â”‚ - PostgreSQL 15                         â”‚
â”‚ - CPU: 16ì½”ì–´, RAM: 64GB                â”‚
â”‚ - Disk: 1TB NVMe                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìŠ¤í† ë¦¬ì§€ ì„œë²„: NFS                       â”‚
â”‚ - ëŒ€ìš©ëŸ‰ ìŠ¤í† ë¦¬ì§€ (10-50TB)              â”‚
â”‚ - RAID 6/10 (ì•ˆì •ì„±)                    â”‚
â”‚ - 10Gbps ë„¤íŠ¸ì›Œí¬                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì¥ì :**
- âœ… í™•ì¥ì„± ìš°ìˆ˜
- âœ… ê° ì„œë¹„ìŠ¤ ë…ë¦½ì  ìŠ¤ì¼€ì¼ë§
- âœ… ê³ ê°€ìš©ì„± êµ¬í˜„ ê°€ëŠ¥
- âœ… ì„±ëŠ¥ ìµœì í™”

**ì ìš© ì‹œë‚˜ë¦¬ì˜¤:**
```
ë°ì´í„° ê·œëª¨:
- íŒŒí‹°ì…˜: 50-500ê°œ
- ì´ ë°ì´í„°: 15ì–µ-150ì–µ ë²¡í„°
- ì´ ìš©ëŸ‰: 2.5TB - 25TB

ì„±ëŠ¥:
- ê²€ìƒ‰ ì†ë„: 15ms
- ë™ì‹œ ìš”ì²­: 500-2000 req/s
```

---

### ë°©ì•ˆ 3: Kubernetes (Large Scale) ğŸš€ ì—”í„°í”„ë¼ì´ì¦ˆ

**êµ¬ì„±:**
```
Kubernetes Cluster
â”œâ”€â”€ FastAPI Pods (Auto-scaling)
â”‚   â”œâ”€â”€ Pod 1-10 (ë™ì )
â”‚   â””â”€â”€ HPA (Horizontal Pod Autoscaler)
â”‚
â”œâ”€â”€ Milvus Cluster
â”‚   â”œâ”€â”€ Query Nodes Ã— 3
â”‚   â”œâ”€â”€ Data Nodes Ã— 3
â”‚   â”œâ”€â”€ Index Nodes Ã— 2
â”‚   â””â”€â”€ Root Coord
â”‚
â”œâ”€â”€ PostgreSQL HA
â”‚   â”œâ”€â”€ Primary
â”‚   â”œâ”€â”€ Standby Ã— 2
â”‚   â””â”€â”€ pgpool (Load Balancer)
â”‚
â””â”€â”€ Persistent Volumes
    â”œâ”€â”€ NFS Provisioner
    â””â”€â”€ StorageClass
```

**ì¥ì :**
- âœ… ìë™ ìŠ¤ì¼€ì¼ë§
- âœ… ê³ ê°€ìš©ì„± (HA)
- âœ… ë¬´ì¤‘ë‹¨ ë°°í¬
- âœ… ë¬´ì œí•œ í™•ì¥

**ì ìš© ì‹œë‚˜ë¦¬ì˜¤:**
```
ë°ì´í„° ê·œëª¨:
- íŒŒí‹°ì…˜: 500ê°œ+
- ì´ ë°ì´í„°: 150ì–µ+ ë²¡í„°
- ì´ ìš©ëŸ‰: 25TB+

ì„±ëŠ¥:
- ê²€ìƒ‰ ì†ë„: 10-15ms
- ë™ì‹œ ìš”ì²­: 2000+ req/s
```

---

## ğŸ¯ ìš´ì˜ ì„œë²„ êµ¬ì„± ê¶Œì¥ì‚¬í•­

### Phase 1: ì‹œì‘ ë‹¨ê³„ (ë‹¨ì¼ ì„œë²„)

```yaml
# docker-compose.production.yml ì‚¬ìš©

ì„œë²„ ì‚¬ì–‘:
- CPU: 32ì½”ì–´
- RAM: 128GB
- SSD: 2TB NVMe (ìºì‹œ)
- Storage: 10TB NFS

ì˜ˆìƒ ë¹„ìš©: $500-1000/ì›” (ë² ì–´ë©”íƒˆ)

í™•ì¥ ê°€ëŠ¥:
- íŒŒí‹°ì…˜ 50ê°œê¹Œì§€
- 15ì–µ ë²¡í„°ê¹Œì§€
```

### Phase 2: ì„±ì¥ ë‹¨ê³„ (ì„œë¹„ìŠ¤ ë¶„ë¦¬)

```yaml
ì„œë²„ êµ¬ì„±:
1. FastAPI ì„œë²„ (16ì½”ì–´, 32GB) Ã— 1-2ëŒ€
2. Milvus ì„œë²„ (32ì½”ì–´, 256GB) Ã— 1ëŒ€
3. PostgreSQL ì„œë²„ (16ì½”ì–´, 64GB) Ã— 1ëŒ€
4. NFS ìŠ¤í† ë¦¬ì§€ (50TB) Ã— 1ëŒ€

ì˜ˆìƒ ë¹„ìš©: $2000-3000/ì›”

í™•ì¥ ê°€ëŠ¥:
- íŒŒí‹°ì…˜ 500ê°œê¹Œì§€
- 150ì–µ ë²¡í„°ê¹Œì§€
```

### Phase 3: ì—”í„°í”„ë¼ì´ì¦ˆ (Kubernetes)

```yaml
Kubernetes í´ëŸ¬ìŠ¤í„°:
- Worker Nodes: 10-20ëŒ€
- Master Nodes: 3ëŒ€
- Storage: Ceph/GlusterFS (100TB+)

ì˜ˆìƒ ë¹„ìš©: $10,000+/ì›”

í™•ì¥ ê°€ëŠ¥:
- ë¬´ì œí•œ
```

---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡° (ìš´ì˜)

### ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ êµ¬ì¡°

```
/mnt/storage/rag-data/              # NFS ë§ˆìš´íŠ¸ í¬ì¸íŠ¸
â”œâ”€â”€ milvus/                         # Milvus ë°ì´í„°
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ collection_chatty/
â”‚   â”‚   â”‚   â”œâ”€â”€ bot_550e8400.../   # íŒŒí‹°ì…˜ ë°ì´í„°
â”‚   â”‚   â”‚   â”œâ”€â”€ bot_7c9e6679.../
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ indexes/
â”‚   â”œâ”€â”€ logs/
â”‚   â””â”€â”€ wal/
â”‚
â”œâ”€â”€ postgres/                       # PostgreSQL ë°ì´í„°
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â””â”€â”€ rag_db_chatty/
â”‚   â”‚       â”œâ”€â”€ documents_550e8400.../  # íŒŒí‹°ì…˜ í…Œì´ë¸”
â”‚   â”‚       â”œâ”€â”€ documents_7c9e6679.../
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ pg_wal/
â”‚   â””â”€â”€ pg_log/
â”‚
â”œâ”€â”€ etcd/                           # etcd ë©”íƒ€ë°ì´í„°
â”‚   â””â”€â”€ member/
â”‚
â”œâ”€â”€ minio/                          # MinIO ê°ì²´ ìŠ¤í† ë¦¬ì§€
â”‚   â””â”€â”€ .minio.sys/
â”‚
â””â”€â”€ backups/                        # ë°±ì—… ë””ë ‰í† ë¦¬
    â”œâ”€â”€ daily/
    â”œâ”€â”€ weekly/
    â””â”€â”€ monthly/
```

---

## ğŸ³ ìš´ì˜ ì„œë²„ Docker Compose êµ¬ì„±

### ì„œë¹„ìŠ¤ ë¶„ë¦¬í˜• (ê¶Œì¥)

**ì„œë²„ 1: FastAPI**
```yaml
# docker-compose.fastapi.yml
version: '3.8'

services:
  fastapi:
    container_name: rag-fastapi
    build:
      context: ../
      dockerfile: Dockerfile
    environment:
      - MILVUS_HOST=milvus-server.internal  # Milvus ì„œë²„ ì£¼ì†Œ
      - POSTGRES_HOST=postgres-server.internal
    ports:
      - "8000:8000"
    restart: unless-stopped
    deploy:
      replicas: 4  # 4ê°œ ì¸ìŠ¤í„´ìŠ¤
      resources:
        limits:
          cpus: '4'
          memory: 8G
```

**ì„œë²„ 2: Milvus**
```yaml
# docker-compose.milvus.yml
version: '3.8'

services:
  etcd:
    # ... etcd ì„¤ì •
    volumes:
      - /mnt/storage/rag-data/etcd:/etcd

  minio:
    # ... minio ì„¤ì •
    volumes:
      - /mnt/storage/rag-data/minio:/minio_data

  milvus:
    # ... milvus ì„¤ì •
    volumes:
      - /mnt/storage/rag-data/milvus:/var/lib/milvus
    ports:
      - "19530:19530"  # ì™¸ë¶€ ì ‘ì† í—ˆìš©
```

**ì„œë²„ 3: PostgreSQL**
```yaml
# docker-compose.postgres.yml
version: '3.8'

services:
  postgres:
    # ... postgres ì„¤ì •
    volumes:
      - /mnt/storage/rag-data/postgres:/var/lib/postgresql/data
    ports:
      - "5432:5432"  # ì™¸ë¶€ ì ‘ì† í—ˆìš©
```

---

## ğŸ” ë³´ì•ˆ ì„¤ì • (ìš´ì˜)

### 1. ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬

```yaml
# í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
networks:
  frontend:
    driver: bridge
  backend:
    driver: bridge
    internal: true  # ì™¸ë¶€ ì ‘ì† ì°¨ë‹¨

services:
  fastapi:
    networks:
      - frontend
      - backend
  
  milvus:
    networks:
      - backend  # ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë§Œ
  
  postgres:
    networks:
      - backend  # ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë§Œ
```

### 2. ì ‘ê·¼ ì œì–´

```yaml
# PostgreSQL
environment:
  POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}  # ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸
  POSTGRES_HOST_AUTH_METHOD: md5           # ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ í•„ìˆ˜

# Milvus
# API í‚¤ ë˜ëŠ” OAuth ì¶”ê°€
```

### 3. SSL/TLS ì ìš©

```yaml
# FastAPIì— SSL ì¸ì¦ì„œ ì ìš©
fastapi:
  volumes:
    - /etc/letsencrypt:/etc/letsencrypt:ro
  command: >
    uvicorn app.main:app
    --host 0.0.0.0
    --port 443
    --ssl-keyfile /etc/letsencrypt/live/domain.com/privkey.pem
    --ssl-certfile /etc/letsencrypt/live/domain.com/fullchain.pem
```

---

## ğŸ—ï¸ ìš´ì˜ ì„œë²„ ê¶Œì¥ ì•„í‚¤í…ì²˜

### ì˜µì…˜ A: ë‹¨ì¼ ì„œë²„ + ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ (ì†Œê·œëª¨)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìš´ì˜ ì„œë²„ (32ì½”ì–´, 128GB RAM)            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Docker Compose                   â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€ FastAPI (:8000)              â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€ Milvus (:19530)              â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€ PostgreSQL (:5432)           â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€ Attu (:3000)                 â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€ etcd                         â”‚  â”‚
â”‚  â”‚ â””â”€â”€ MinIO                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“ (ë°ì´í„° ì €ì¥)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NFS ìŠ¤í† ë¦¬ì§€ ì„œë²„ (10-50TB)             â”‚
â”‚ /export/rag-data/                       â”‚
â”‚ â”œâ”€â”€ milvus/ (ë²¡í„° ë°ì´í„°)               â”‚
â”‚ â”œâ”€â”€ postgres/ (ë©”íƒ€ë°ì´í„°)              â”‚
â”‚ â””â”€â”€ backups/ (ë°±ì—…)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì˜ˆìƒ ë¹„ìš©: $1,000-2,000/ì›”
ì§€ì› ê·œëª¨: íŒŒí‹°ì…˜ 50ê°œ, 15ì–µ ë²¡í„°
```

**Docker Compose íŒŒì¼:**
```yaml
# docker-compose.production.yml ì‚¬ìš©
# STORAGE_SERVER_PATH=/mnt/storage/rag-data
```

**ì‹¤í–‰:**
```bash
# 1. NFS ë§ˆìš´íŠ¸
./mount-storage.sh

# 2. Docker Compose ì‹¤í–‰
docker-compose -f docker-compose.production.yml up -d
```

---

### ì˜µì…˜ B: ì„œë¹„ìŠ¤ ë¶„ë¦¬ (ì¤‘ëŒ€ê·œëª¨) â­ ê¶Œì¥ (í™•ì¥)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 1-2: FastAPI (16ì½”ì–´, 32GB)     â”‚
â”‚ - Nginx Load Balancer               â”‚
â”‚ - FastAPI Ã— 4 ì¸ìŠ¤í„´ìŠ¤               â”‚
â”‚ - ì„ë² ë”© ì²˜ë¦¬                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (ìš”ì²­)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 3: Milvus (64ì½”ì–´, 512GB)       â”‚
â”‚ - Milvus Standalone                 â”‚
â”‚ - etcd, MinIO                       â”‚
â”‚ - 300ë§Œ Ã— 100ê°œ íŒŒí‹°ì…˜ = 30ì–µ ë²¡í„°   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ 4: PostgreSQL (32ì½”ì–´, 128GB)   â”‚
â”‚ - PostgreSQL 15 (íŒŒí‹°ì…”ë‹)          â”‚
â”‚ - 100ê°œ íŒŒí‹°ì…˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìŠ¤í† ë¦¬ì§€ ì„œë²„: NFS (50TB)            â”‚
â”‚ - RAID 6/10                         â”‚
â”‚ - 10Gbps ë„¤íŠ¸ì›Œí¬                    â”‚
â”‚ - ìë™ ë°±ì—…                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì˜ˆìƒ ë¹„ìš©: $5,000-8,000/ì›”
ì§€ì› ê·œëª¨: íŒŒí‹°ì…˜ 100-500ê°œ, 30ì–µ-150ì–µ ë²¡í„°
```

**ê° ì„œë²„ë³„ Docker Compose:**

**ì„œë²„ 1 (FastAPI):**
```yaml
# docker-compose.fastapi.yml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - fastapi

  fastapi:
    build: ../
    environment:
      MILVUS_HOST: 192.168.1.101  # Milvus ì„œë²„ IP
      POSTGRES_HOST: 192.168.1.102  # PostgreSQL ì„œë²„ IP
    deploy:
      replicas: 4
```

**ì„œë²„ 2 (Milvus):**
```yaml
# docker-compose.milvus.yml
version: '3.8'

services:
  etcd:
    # ...
    volumes:
      - /mnt/storage/rag-data/etcd:/etcd

  minio:
    # ...
    volumes:
      - /mnt/storage/rag-data/minio:/minio_data

  milvus:
    # ...
    volumes:
      - /mnt/storage/rag-data/milvus:/var/lib/milvus
    ports:
      - "0.0.0.0:19530:19530"  # ëª¨ë“  ë„¤íŠ¸ì›Œí¬ì—ì„œ ì ‘ì†
```

**ì„œë²„ 3 (PostgreSQL):**
```yaml
# docker-compose.postgres.yml
version: '3.8'

services:
  postgres:
    # ...
    volumes:
      - /mnt/storage/rag-data/postgres:/var/lib/postgresql/data
    ports:
      - "0.0.0.0:5432:5432"
```

---

### ì˜µì…˜ C: Kubernetes + Helm (ì—”í„°í”„ë¼ì´ì¦ˆ)

```
Kubernetes Cluster (10-20 Nodes)
â”œâ”€â”€ Namespace: rag-production
â”‚   â”œâ”€â”€ FastAPI Deployment (HPA)
â”‚   â”œâ”€â”€ Milvus Cluster (Helm Chart)
â”‚   â”œâ”€â”€ PostgreSQL HA (Operator)
â”‚   â””â”€â”€ Ingress (HTTPS)
â”‚
â””â”€â”€ Storage
    â”œâ”€â”€ PersistentVolume (NFS/Ceph)
    â””â”€â”€ StorageClass (ë™ì  í”„ë¡œë¹„ì €ë‹)

ì˜ˆìƒ ë¹„ìš©: $10,000+/ì›”
ì§€ì› ê·œëª¨: ë¬´ì œí•œ
```

---

## ğŸ“Š êµ¬ì„± ë¹„êµí‘œ

| í•­ëª© | í…ŒìŠ¤íŠ¸ | ë‹¨ì¼ ì„œë²„ | ì„œë¹„ìŠ¤ ë¶„ë¦¬ | Kubernetes |
|------|--------|----------|------------|------------|
| **ì„œë²„ ìˆ˜** | 1 | 1-2 | 4-5 | 10+ |
| **CPU** | 8ì½”ì–´ | 32ì½”ì–´ | 128ì½”ì–´ | ë¬´ì œí•œ |
| **RAM** | 32GB | 128GB | 512GB+ | ë¬´ì œí•œ |
| **ìŠ¤í† ë¦¬ì§€** | 500GB | 10TB | 50TB | ë¬´ì œí•œ |
| **íŒŒí‹°ì…˜** | 1-10 | 10-50 | 50-500 | ë¬´ì œí•œ |
| **ë™ì‹œ ìš”ì²­** | 10-50 | 100-500 | 500-2000 | ë¬´ì œí•œ |
| **ê³ ê°€ìš©ì„±** | âŒ | âš ï¸ | âœ… | âœ… |
| **ìë™ í™•ì¥** | âŒ | âŒ | âš ï¸ | âœ… |
| **ë¹„ìš©/ì›”** | $100 | $1,000 | $5,000 | $10,000+ |
| **ë³µì¡ë„** | ë‚®ìŒ | ì¤‘ê°„ | ë†’ìŒ | ë§¤ìš° ë†’ìŒ |
| **ê¶Œì¥ ì‹œê¸°** | ê°œë°œ | ì‹œì‘ | ì„±ì¥ | ëŒ€ê·œëª¨ |

---

## ğŸ¯ ë‹¨ê³„ë³„ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

### 1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ í™˜ê²½ (ì§€ê¸ˆ)

```bash
# ë¡œì»¬ Docker Compose
docker-compose up -d

ëª©ì : ê°œë°œ ë° í…ŒìŠ¤íŠ¸
ê¸°ê°„: 1-3ê°œì›”
```

### 2ë‹¨ê³„: ë‹¨ì¼ ì„œë²„ ìš´ì˜ (ì´ˆê¸° ëŸ°ì¹­)

```bash
# ìš´ì˜ ì„œë²„ + ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€
docker-compose -f docker-compose.production.yml up -d

ëª©ì : ì„œë¹„ìŠ¤ ì‹œì‘
ì˜ˆìƒ ì‚¬ìš©ì: 1,000-10,000ëª…
ê¸°ê°„: 3-12ê°œì›”
```

### 3ë‹¨ê³„: ì„œë¹„ìŠ¤ ë¶„ë¦¬ (ì„±ì¥ê¸°)

```bash
# ê° ì„œë²„ì— ê°œë³„ Docker Compose
ì„œë²„1: FastAPI
ì„œë²„2: Milvus
ì„œë²„3: PostgreSQL
ì„œë²„4: NFS Storage

ëª©ì : í™•ì¥ì„± í™•ë³´
ì˜ˆìƒ ì‚¬ìš©ì: 10,000-100,000ëª…
ê¸°ê°„: 1-2ë…„
```

### 4ë‹¨ê³„: Kubernetes (ì„±ìˆ™ê¸°)

```bash
# Kubernetes í´ëŸ¬ìŠ¤í„°
helm install milvus milvus/milvus
helm install postgresql bitnami/postgresql-ha

ëª©ì : ë¬´ì œí•œ í™•ì¥
ì˜ˆìƒ ì‚¬ìš©ì: 100,000+ëª…
```

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (ìš´ì˜ ì„œë²„)

### ë‹¨ì¼ ì„œë²„ êµ¬ì„±

```bash
# 1. NFS ìŠ¤í† ë¦¬ì§€ ë§ˆìš´íŠ¸
cd 01.Docker_compose
sudo ./mount-storage.sh
# NFS ì„ íƒ â†’ ìŠ¤í† ë¦¬ì§€ ì„œë²„ IP ì…ë ¥

# 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
cp .env.production .env
nano .env
# STORAGE_SERVER_PATH=/mnt/storage/rag-data í™•ì¸

# 3. Docker Compose ì‹¤í–‰
docker-compose -f docker-compose.production.yml up -d

# 4. ìƒíƒœ í™•ì¸
./status.sh

# 5. ë°±ì—… ì„¤ì •
crontab -e
# 0 2 * * * /path/to/01.Docker_compose/backup.sh
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ (ìš´ì˜ í•„ìˆ˜)

### Prometheus + Grafana ì¶”ê°€

```yaml
# docker-compose.monitoring.yml
services:
  prometheus:
    image: prom/prometheus
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - /mnt/storage/rag-data/prometheus:/prometheus
    ports:
      - "9090:9090"

  grafana:
    image: grafana/grafana
    volumes:
      - /mnt/storage/rag-data/grafana:/var/lib/grafana
    ports:
      - "3001:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
```

---

## âœ… ê¶Œì¥ ì‹œì‘ ì „ëµ

### í˜„ì¬ ìƒí™© â†’ ë‹¨ì¼ ì„œë²„ ìš´ì˜ (Phase 1)

```
1. í…ŒìŠ¤íŠ¸ í™˜ê²½ (ë¡œì»¬)
   â””â”€â”€ docker-compose.yml ì‚¬ìš©
   â””â”€â”€ ë°ì´í„° ê·œëª¨ ê²€ì¦

2. ìš´ì˜ ì„œë²„ (ë‹¨ì¼ ì„œë²„ + NFS)
   â””â”€â”€ docker-compose.production.yml ì‚¬ìš©
   â””â”€â”€ ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ ì—°ë™
   â””â”€â”€ íŒŒí‹°ì…˜ 50ê°œê¹Œì§€ ì§€ì›

3. í™•ì¥ ì‹œì  (íŒŒí‹°ì…˜ 50ê°œ ì´ˆê³¼)
   â””â”€â”€ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ê²€í† 
   â””â”€â”€ Milvus ì „ìš© ì„œë²„ êµ¬ì„±
```

**í•µì‹¬**: ì²˜ìŒë¶€í„° ë³µì¡í•˜ê²Œ êµ¬ì„±í•˜ì§€ ë§ê³ , **ë‹¨ì¼ ì„œë²„ë¡œ ì‹œì‘**í•´ì„œ í•„ìš”ì‹œ ë‹¨ê³„ì ìœ¼ë¡œ í™•ì¥! ğŸš€

í˜„ì¬ëŠ” **docker-compose.production.yml + NFS ìŠ¤í† ë¦¬ì§€**ë¡œ ì‹œì‘í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤!

